(()=>{"use strict";var t,e,s,i,o,a={73:(t,e,s)=>{s.a(t,async(t,e)=>{try{var i=s(1266),o=s(5418),a=s(7867),n=s(7782),r=s(4994);(0,o.Nw)();const h=document.createElement("canvas");document.body.appendChild(h);const l=h.transferControlToOffscreen(),c=new Image;c.src="assets/joystick/joystick.png";const d=new Image;d.src="assets/joystick/knob.png",new a.Z(document.body,{onMove:(t,e)=>g.postMessage({type:"heroMove",r:t,d:e}),onRelease:()=>g.postMessage({type:"heroRelease"}),onKeyDown:t=>{"KeyA"===t&&g.postMessage({type:"heroAttack"})},joystickImage:c,knobImage:d,maxKnobDistance:70});const u=document.createElement("div");(0,i.eC)(u,{position:"absolute",top:"0",left:"0",display:"flex",flexDirection:"column"}),document.body.appendChild(u);const m=o.pl?new i.Kf(u,"Logic"):void 0,f=o.pl?new i.Kf(u,"Physics"):void 0,w=o.pl?new i.Kf(u,"Transform"):void 0,p=o.pl?new i.Kf(u,"Render"):void 0,g=new Worker("logic-worker.js");g.onmessage=t=>{const e=t.data.type;m&&"fps"===e&&(m.fps=t.data.value),"changeHp"===e&&((0,r.Xb)(t.data.hp),t.data.hp<=0&&(0,r.iY)()),"changeScore"===e&&(0,r.oz)(t.data.score),"playMusic"===e&&i.rF.play(t.data.asset),"pauseMusic"===e&&i.rF.pause(),"stopMusic"===e&&i.rF.stop(),"playSfx"===e&&i.dy.play(t.data.asset),"playSfxRandom"===e&&i.dy.playRandom(...t.data.assets)};const y=new Worker("physics-worker.js");y.onmessage=t=>{const e=t.data.type;f&&"fps"===e&&(f.fps=t.data.value)};const _=new Worker("transform-worker.js");_.onmessage=t=>{const e=t.data.type;w&&"fps"===e&&(w.fps=t.data.value)};const v=new Worker("render-worker.js");v.onmessage=t=>{const e=t.data.type;"graphicAssetLoaded"===e&&x.markLoaded(t.data.id),p&&"fps"===e&&(p.fps=t.data.value)};const x=new i.Z(n.r,[n.A.SPRITE_HERO,n.A.SPRITE_ORC,n.A.SPRITE_POTION,n.A.FONT_WHITE_PEABERRY,n.A.BGM_BATTLE,n.A.SFX_HERO_HIT_1,n.A.SFX_HERO_HIT_2,n.A.SFX_HERO_HIT_3,n.A.SFX_HERO_MISS_1,n.A.SFX_HERO_MISS_2,n.A.SFX_HERO_MISS_3,n.A.SFX_HERO_HEAL,n.A.SFX_HERO_DIE,n.A.SFX_ORC_HIT_1,n.A.SFX_ORC_HIT_2,n.A.SFX_ORC_HIT_3,n.A.SFX_ORC_MISS_1,n.A.SFX_ORC_MISS_2,n.A.SFX_ORC_MISS_3,n.A.SFX_ORC_DIE]);v.postMessage({type:"loadGraphicAssets",assets:[n.A.SPRITE_HERO,n.A.SPRITE_ORC,n.A.SPRITE_POTION,n.A.FONT_WHITE_PEABERRY]}),await x.preload();const S=(0,i.ZU)(),I=new MessageChannel;function k(t,e){(0,i.eC)(h,{width:`${t}px`,height:`${e}px`}),v.postMessage({type:"resize",containerWidth:t,containerHeight:e})}g.postMessage({type:"init",sab:S,port:I.port1},[I.port1]),y.postMessage({type:"init",sab:S}),_.postMessage({type:"init",sab:S}),v.postMessage({type:"init",offscreenCanvas:l,devicePixelRatio:window.devicePixelRatio,sab:S,port:I.port2},[l,I.port2]),k(window.innerWidth,window.innerHeight),window.addEventListener("resize",()=>k(window.innerWidth,window.innerHeight)),(0,r.xY)(),e()}catch(b){e(b)}},1)},331:(t,e,s)=>{s.d(e,{I:()=>i});class i{#t;#e;constructor(t,e,s,i){this.#e=s,this.#t=new Uint32Array(t,e,s*i)}static bytesRequired(t,e){return t*e*Uint32Array.BYTES_PER_ELEMENT}get byteLength(){return this.#t.byteLength}#s(t){return t*this.#e}set(t,e,s){this.#t[this.#s(t)+e]=s}get(t,e){return this.#t[this.#s(t)+e]}}},1266:(t,e,s)=>{s.d(e,{Kf:()=>k,Z:()=>P,ZU:()=>R,rF:()=>c,eC:()=>u,dy:()=>d});class i{cachedAssets=new Map;loadingPromises=new Map;#i=new Map;#o(t){this.#i.set(t,(this.#i.get(t)||0)+1)}hasActiveRef(t){return this.#i.get(t)>0}cleanup(t,e){}checkCached(t){return this.cachedAssets.has(t)}getCached(t){if(!this.checkCached(t))throw new Error(`Asset not found: ${t}`);return this.#o(t),this.cachedAssets.get(t)}async load(t,...e){return this.#o(t),this.checkCached(t)?this.cachedAssets.get(t):this.loadingPromises.has(t)?await this.loadingPromises.get(t):await this.doLoad(t,...e)}release(t){const e=this.#i.get(t);if(void 0===e)throw new Error(`Asset not found: ${t}`);if(1===e){this.#i.delete(t);const e=this.cachedAssets.get(t);e&&(this.cleanup(t,e),this.cachedAssets.delete(t))}else this.#i.set(t,e-1)}}const o=new class extends i{async doLoad(t,e){const s=(async()=>{const s=await fetch(e);if(s.ok)try{const i=await s.arrayBuffer(),o=await n.decodeAudioData(i);if(this.loadingPromises.delete(t),this.hasActiveRef(t)){if(!this.cachedAssets.has(t))return this.cachedAssets.set(t,o),o;console.error(`Audio buffer already exists: ${e}`)}}catch(s){console.error(`Failed to decode audio data: ${e}`,s),this.loadingPromises.delete(t)}else console.error(`Failed to load audio data: ${e}`)})();return this.loadingPromises.set(t,s),await s}},a=/Android|iPhone|iPad|iPod/i.test(navigator.userAgent),n=new(window.AudioContext||window.webkitAudioContext);window.addEventListener("mousedown",()=>n.resume()),window.addEventListener("touchend",()=>n.resume());let r=!document.hidden;window.addEventListener("visibilitychange",()=>r=!document.hidden);const h=function(){const t=(()=>{const t=new Map;return{persistent:!1,getItem:e=>t.has(e)?t.get(e):null,setItem:(e,s)=>{t.set(e,String(s))},removeItem:e=>{t.delete(e)}}})();if("undefined"==typeof window)return t;try{const t=window.localStorage,e="__safe_ls_probe__"+Math.random().toString(36).slice(2);return t.setItem(e,"1"),t.removeItem(e),{persistent:!0,getItem:e=>t.getItem(e),setItem:(e,s)=>t.setItem(e,s),removeItem:e=>t.removeItem(e)}}catch{return t}}();class l{assetId;#a;#n;#r;#h;#l;#c;#d=!1;#u=!1;#m=0;#f=0;#w=0;constructor(t,e,s){this.assetId=t,this.#a=e,this.#n=s,this.play()}get volume(){return this.#a}set volume(t){this.#a=t,this.#l&&(this.#l.gain.value=Math.max(0,Math.min(1,t)))}async play(){a&&!r||(this.#r||(o.checkCached(this.assetId)?this.#r=o.getCached(this.assetId):(console.info(`Audio not preloaded. Loading now: ${this.assetId}`),this.#r=await o.load(this.assetId))),this.#r&&(this.#d&&this.stop(),this.#u||(this.#w=0),this.#d=!0,this.#u=!1,this.#h||(this.#h=await async function(){return"suspended"===n.state&&await n.resume(),n}()),this.#d&&(this.#l||(this.#l=this.#h.createGain(),this.#l.gain.value=this.#a,this.#l.connect(this.#h.destination)),this.#c=this.#h.createBufferSource(),this.#c.buffer=this.#r,this.#c.loop=this.#n,this.#c.connect(this.#l),this.#c.start(0,this.#w),this.#m=this.#h.currentTime,this.#c.onended=()=>{this.#u||this.#n||this.stop()})))}#p(){this.#c&&(this.#c.stop(),this.#c.disconnect(),this.#c=void 0)}pause(){this.#d&&!this.#u&&(this.#h&&(this.#f=this.#h.currentTime,this.#w+=this.#f-this.#m),this.#u=!0,this.#d=!1,this.#p())}stop(){this.#d=!1,this.#u=!1,this.#w=0,this.#p()}}const c=new class{#a=.7;#g;constructor(){const t=parseFloat(h.getItem("musicVolume")||"");this.#a=Number.isNaN(t)?this.#a:t,a&&document.addEventListener("visibilitychange",()=>{document.hidden?this.pause():(r=!0,this.#g?.play())})}get volume(){return this.#a}set volume(t){this.#a=t,h.setItem("musicVolume",t.toString()),this.#g&&(this.#g.volume=t)}play(t){this.#g?.assetId!==t&&(this.#g?.stop(),this.#g=new l(t,this.#a,!0))}pause(){this.#g?.pause()}stop(){this.#g?.stop(),this.#g=void 0}},d=new class{#a=1;constructor(){const t=parseFloat(h.getItem("sfxVolume")||"");this.#a=Number.isNaN(t)?this.#a:t}get volume(){return this.#a}set volume(t){this.#a=t,h.setItem("sfxVolume",t.toString())}play(t){new l(t,this.#a,!1)}playRandom(...t){this.play(t[Math.floor(Math.random()*t.length)])}};function u(t,e){if(t)return Object.assign(t.style,e),t}const m=window.devicePixelRatio,f=80*m,w=48*m,p=3*m,g=2*m,y=3*m,_=15*m,v=74*m,x=30*m,S=Math.round;function I(t,e,s=0){const{r:i,g:o,b:a}=function(t){const e=t.replace("#",""),s=3===e.length?e.split("").map(t=>t+t).join(""):e,i=parseInt(s,16);return{r:i>>16&255,g:i>>8&255,b:255&i}}(t),{h:n,s:r,l:h}=function(t,e,s){t/=255,e/=255,s/=255;const i=Math.max(t,e,s),o=Math.min(t,e,s);let a=0,n=0;const r=(i+o)/2;if(i!==o){const h=i-o;switch(n=r>.5?h/(2-i-o):h/(i-o),i){case t:a=(e-s)/h+(e<s?6:0);break;case e:a=(s-t)/h+2;break;case s:a=(t-e)/h+4}a*=60}return{h:a,s:n,l:r}}(i,o,a),l=(n+e)%360;return function(t,e,s){const i=(1-Math.abs(2*s-1))*e,o=i*(1-Math.abs(t/60%2-1)),a=s-i/2;let n=0,r=0,h=0;0<=t&&t<60?(n=i,r=o,h=0):60<=t&&t<120?(n=o,r=i,h=0):120<=t&&t<180?(n=0,r=i,h=o):180<=t&&t<240?(n=0,r=o,h=i):240<=t&&t<300?(n=o,r=0,h=i):(n=i,r=0,h=o);const l=t=>Math.round(255*(t+a)).toString(16).padStart(2,"0");return`#${l(n)}${l(r)}${l(h)}`}(l<0?l+360:l,r,Math.max(0,Math.min(1,h+s)))}class k{static#y=0;#_;#v;#x;#S=1/0;#I=0;#k=0;#b;#R;#E;constructor(t,e){this.#x=e;const s=k.#y++;this.#R=I("#0ff",18*s,0),this.#E=I("#002",18*s,.02);const i=document.createElement("canvas");t.appendChild(i),i.width=f,i.height=w,i.style.cssText="width:80px;height:48px";const o=i.getContext("2d");if(!o)throw new Error("2D context not available");o.font=`bold ${9*m}px Helvetica,Arial,sans-serif`,o.textBaseline="top",o.globalAlpha=1,o.fillStyle=this.#E,o.fillRect(0,0,f,w),o.fillStyle=this.#R,o.fillText(e,p,g),o.fillRect(y,_,v,x),o.fillStyle=this.#E,o.globalAlpha=.9,o.fillRect(y,_,v,x),this.#_=i,this.#v=o,this.#b=setInterval(()=>this.#F(),1e3)}#F(){const t=this.#v;if(this.#S===1/0)return;t.globalAlpha=1,t.fillStyle=this.#E,t.fillRect(0,0,f,_),t.fillStyle=this.#R;const e=`${S(this.#k)} ${this.#x} (${S(this.#S)}-${S(this.#I)})`;t.fillText(e,p,g),t.drawImage(this.#_,y+m,_,v-m,x,y,_,v-m,x),t.fillStyle=this.#R,t.globalAlpha=1,t.fillRect(y+v-m,_,m,x),t.fillStyle=this.#E,t.globalAlpha=.9;const s=this.#I<100?100:this.#I,i=S((1-this.#k/s)*x);t.fillRect(y+v-m,_,m,i),t.globalAlpha=1}set fps(t){this.#S=Math.min(this.#S,t),this.#I=Math.max(this.#I,t),this.#k=t}get fps(){return this.#k}remove(){clearInterval(this.#b),this.#_.remove()}}var b=s(5418);function R(){const t=new SharedArrayBuffer(b.jy.bytesRequired()),e=new b.F9(t,0,b.$5-1);for(let t=1;t<b.$5;t++)e.enqueue(t);let s=b.s6.bytesRequired(b.$5);return new Uint32Array(t,s,b.Fr*b.$5).fill(b.x3),s+=b.aD.bytesRequired(b.$5),s+=b.bp.bytesRequired(b.pn,b.$5),new Uint32Array(t,s,b.Qb*b.$5).fill(b.x3),s+=b.Iu.bytesRequired(b.Qb,b.$5),new Float32Array(t,s,b.sB*b.$5).fill(NaN),t}const E=new class extends i{async doLoad(t,e){const s=(async()=>{if("fonts"in document)try{return await document.fonts.load(`1em ${e}`),await document.fonts.ready,this.loadingPromises.delete(t),!0}catch(s){console.error(`Failed to load font: ${e}`,s),this.loadingPromises.delete(t)}else console.warn("This browser does not support the Font Loading API"),this.loadingPromises.delete(t)})();return this.loadingPromises.set(t,s),await s}},F=Symbol("EXTERNAL_LOADER"),A=[{check:t=>t.endsWith(".json")||t.endsWith(".atlas"),loader:F},{check:t=>t.endsWith(".skel"),loader:F},{check:t=>/\.(png|jpe?g|gif|webp)$/.test(t),loader:F},{check:t=>/\.(mp3|wav|ogg)$/.test(t),loader:o},{check:t=>!t.includes("."),loader:E}],T=new Map;async function C(t,e){if("string"==typeof e){const i=(s=e,A.find(({check:t})=>t(s))?.loader);return i?(T.set(t,i),i!==F&&(await i.load(t,e),!0)):(console.warn(`No loader found for asset: ${e}`),!0)}return"atlas"in e||"fnt"in e?(T.set(t,F),!1):(console.warn(`Unknown asset type: ${e}`),!0);var s}class P{#A;#T;#C=new Set;#P;constructor(t,e,s){this.#A=new Set(e),this.#T=s;for(const e of this.#A)C(e,t[e]).then(t=>{t&&this.markLoaded(e)})}async preload(){if(this.#C.size!==this.#A.size)return new Promise(t=>this.#P=t)}markLoaded(t){this.#C.add(t);const e=this.#A.size;this.#T?.(this.#C.size/e),this.#C.size===e&&this.#P?.()}}},1853:(t,e,s)=>{s.d(e,{N:()=>o,p:()=>i});let i=!1;function o(){i=!0}},2228:(t,e,s)=>{var i;!function(t){t[t.GameObject=0]="GameObject",t[t.Sprite=1]="Sprite",t[t.AnimatedSprite=2]="AnimatedSprite",t[t.Rectangle=3]="Rectangle",t[t.Circle=4]="Circle",t[t.BitmapText=5]="BitmapText",t[t.PhysicsWorld=6]="PhysicsWorld",t[t.PhysicsObject=7]="PhysicsObject"}(i||(i={}))},2365:(t,e,s)=>{s.d(e,{F:()=>o,a:()=>a});var i=s(5211);const o=5;class a{#O;constructor(t,e,s){this.#O=new Uint32Array(t,e,s*o)}static bytesRequired(t){return t*o*Uint32Array.BYTES_PER_ELEMENT}get byteLength(){return this.#O.byteLength}#s(t){return t*o}parent(t){return this.#O[this.#s(t)+0]}#L(t){return this.#O[this.#s(t)+1]}#X(t){return this.#O[this.#s(t)+2]}#M(t){return this.#O[this.#s(t)+4]}remove(t){const e=this.#s(t),s=this.#O[e+0],o=this.#O[e+3],a=this.#O[e+4];if(s!==i.x){const e=this.#s(s);this.#O[e+1]===t&&(this.#O[e+1]=a),this.#O[e+2]===t&&(this.#O[e+2]=o)}o!==i.x&&(this.#O[this.#s(o)+4]=a),a!==i.x&&(this.#O[this.#s(a)+3]=o)}#H(t,e){const s=this.#s(t),o=this.#s(e);this.#O[o+0]=t,this.#O[o+3]=i.x,this.#O[o+4]=i.x,this.#O[s+1]=e,this.#O[s+2]=e}#B(t,e,s){const o=this.#s(e),a=this.#O[o+4],n=this.#s(s);this.#O[n+0]=t,this.#O[n+3]=e,this.#O[n+4]=a,this.#O[o+4]=s,a!==i.x?this.#O[this.#s(a)+3]=s:this.#O[this.#s(t)+2]=s}#$(t,e,s){const o=this.#s(e),a=this.#O[o+3],n=this.#s(s);this.#O[n+0]=t,this.#O[n+4]=e,this.#O[n+3]=a,this.#O[o+3]=s,a!==i.x?this.#O[this.#s(a)+4]=s:this.#O[this.#s(t)+1]=s}insert(t,e){this.remove(e);const s=this.#X(t);s===i.x?this.#H(t,e):this.#B(t,s,e)}insertAt(t,e,s){this.remove(e);const o=this.#L(t);if(o===i.x)return void this.#H(t,e);if(s<=0)return void this.#$(t,o,e);let a=0,n=o;for(;n!==i.x&&a<s;)n=this.#M(n),a++;n===i.x?this.insert(t,e):this.#$(t,n,e)}forEach(t){let e=i.D;for(;;){t(e);const s=this.#L(e);if(s===i.x)for(;;){if(e===i.D)return;const t=this.#M(e);if(t!==i.x){e=t;break}e=this.parent(e)}else e=s}}sortChildren(t,e){let s=this.#L(t);if(s===i.x||this.#M(s)===i.x)return;const o=[];let a=s;for(;a!==i.x;)o.push(a),a=this.#M(a);o.sort((t,s)=>e(t)-e(s));const n=this.#s(t);this.#O[n+1]=o[0],this.#O[n+2]=o[o.length-1];for(let e=0;e<o.length;e++){const s=o[e],a=this.#s(s),n=e>0?o[e-1]:i.x,r=e<o.length-1?o[e+1]:i.x;this.#O[a+0]=t,this.#O[a+3]=n,this.#O[a+4]=r}}}},2531:(t,e,s)=>{var i;!function(t){t[t.Rectangle=0]="Rectangle",t[t.Circle=1]="Circle",t[t.Polygon=2]="Polygon"}(i||(i={}))},2802:(t,e,s)=>{s.d(e,{F:()=>i});class i{#N;#t;#U;constructor(t,e,s){this.#N=new Uint32Array(t,e,2),this.#t=new Uint32Array(t,e+2*Uint32Array.BYTES_PER_ELEMENT,s),this.#U=s}static bytesRequired(t){return(2+t)*Uint32Array.BYTES_PER_ELEMENT}get byteLength(){return this.#N.byteLength+this.#t.byteLength}enqueue(t){const e=this.#N[1];this.#t[e]=t,this.#N[1]=(e+1)%this.#U}dequeue(){const t=this.#N[0];return this.#N[0]=(t+1)%this.#U,this.#t[t]}}},3208:(t,e,s)=>{s.d(e,{$5:()=>o,Qb:()=>n,jy:()=>h,pn:()=>a,sB:()=>r});var i=s(6145);const o=1e6,a=0,n=5,r=23;class h extends i.f{constructor(t){super(t,a,n,r,o)}static bytesRequired(){return i.f.bytesRequired(a,n,r,o)}setObjectType(t,e){this.setUint32(t,0,e)}getObjectType(t){return this.getUint32(t,0)}setLocalX(t,e){this.setFloat32(t,1,e)}getLocalX(t){return this.getFloat32(t,1)}setLocalY(t,e){this.setFloat32(t,2,e)}getLocalY(t){return this.getFloat32(t,2)}setLocalScaleX(t,e){this.setFloat32(t,3,e)}getLocalScaleX(t){return this.getFloat32(t,3)}setLocalScaleY(t,e){this.setFloat32(t,4,e)}getLocalScaleY(t){return this.getFloat32(t,4)}setLocalPivotX(t,e){this.setFloat32(t,5,e)}getLocalPivotX(t){return this.getFloat32(t,5)}setLocalPivotY(t,e){this.setFloat32(t,6,e)}getLocalPivotY(t){return this.getFloat32(t,6)}setLocalRotation(t,e){this.setFloat32(t,7,e)}getLocalRotation(t){return this.getFloat32(t,7)}setLocalCos(t,e){this.setFloat32(t,8,e)}getLocalCos(t){return this.getFloat32(t,8)}setLocalSin(t,e){this.setFloat32(t,9,e)}getLocalSin(t){return this.getFloat32(t,9)}setLocalAlpha(t,e){this.setFloat32(t,10,e)}getLocalAlpha(t){return this.getFloat32(t,10)}setWorldX(t,e){this.setFloat32(t,11,e)}getWorldX(t){return this.getFloat32(t,11)}setWorldY(t,e){this.setFloat32(t,12,e)}getWorldY(t){return this.getFloat32(t,12)}setWorldScaleX(t,e){this.setFloat32(t,13,e)}getWorldScaleX(t){return this.getFloat32(t,13)}setWorldScaleY(t,e){this.setFloat32(t,14,e)}getWorldScaleY(t){return this.getFloat32(t,14)}setWorldRotation(t,e){this.setFloat32(t,15,e)}getWorldRotation(t){return this.getFloat32(t,15)}setWorldCos(t,e){this.setFloat32(t,16,e)}getWorldCos(t){return this.getFloat32(t,16)}setWorldSin(t,e){this.setFloat32(t,17,e)}getWorldSin(t){return this.getFloat32(t,17)}setWorldAlpha(t,e){this.setFloat32(t,18,e)}getWorldAlpha(t){return this.getFloat32(t,18)}setLayer(t,e){this.setUint32(t,1,e)}getLayer(t){return this.getUint32(t,1)}setDrawOrder(t,e){this.setFloat32(t,0,e)}getDrawOrder(t){return this.getFloat32(t,0)}setTint(t,e){this.setUint32(t,2,e)}getTint(t){return this.getUint32(t,2)}setAssetId(t,e){this.setUint32(t,3,e)}getAssetId(t){return this.getUint32(t,3)}setAnimationId(t,e){this.setUint32(t,4,e)}getAnimationId(t){return this.getUint32(t,4)}setShapeId(t,e){this.setUint32(t,3,e)}getShapeId(t){return this.getUint32(t,3)}setRadius(t,e){this.setFloat32(t,19,e)}getRadius(t){return this.getFloat32(t,19)}setWidth(t,e){this.setFloat32(t,19,e)}getWidth(t){return this.getFloat32(t,19)}setHeight(t,e){this.setFloat32(t,20,e)}getHeight(t){return this.getFloat32(t,20)}setWorldId(t,e){this.setUint32(t,3,e)}getWorldId(t){return this.getUint32(t,3)}setBodyId(t,e){this.setUint32(t,3,e)}getBodyId(t){return this.getUint32(t,3)}setVelocityX(t,e){this.setFloat32(t,19,e)}getVelocityX(t){return this.getFloat32(t,19)}setVelocityY(t,e){this.setFloat32(t,20,e)}getVelocityY(t){return this.getFloat32(t,20)}setTargetX(t,e){this.setFloat32(t,21,e)}getTargetX(t){return this.getFloat32(t,21)}setTargetY(t,e){this.setFloat32(t,22,e)}getTargetY(t){return this.getFloat32(t,22)}#D=t=>this.getDrawOrder(t);sortChildren(t){super.sortChildren(t,this.#D)}}},4994:(t,e,s)=>{s.d(e,{Xb:()=>h,oz:()=>l,xY:()=>r,iY:()=>c});const i=1e4;function o(){const t=document.createElement("div");return t.style.color="white",t.style.position="absolute",t.style.top="10px",t.style.zIndex="1",t}const a=o(),n=o();function r(){a.textContent=`HP: ${i}`,n.textContent="Score: 0",a.style.left="50%",a.style.transform="translate(-50%, 0)",n.style.right="10px",document.body.appendChild(a),document.body.appendChild(n)}function h(t){a.textContent=`HP: ${t}`}function l(t){n.textContent=`Score: ${t}`}function c(){const t=o();t.textContent="Game Over",t.style.left="50%",t.style.top="50%",t.style.transform="translate(-50%, -50%)",document.body.append(t)}},5211:(t,e,s)=>{s.d(e,{D:()=>i,x:()=>o});const i=0,o=4294967295},5418:(t,e,s)=>{s.d(e,{$5:()=>a.$5,F9:()=>h.F,Fr:()=>l.F,Iu:()=>r.I,Nw:()=>o.N,Qb:()=>a.Qb,aD:()=>l.a,bp:()=>n.b,jy:()=>a.jy,pl:()=>o.p,pn:()=>a.pn,s6:()=>c.s,sB:()=>a.sB,x3:()=>i.x});var i=s(5211),o=s(1853),a=s(3208),n=(s(2228),s(9496)),r=s(331),h=s(2802),l=s(2365),c=s(7229);s(2531)},5478:t=>{t.exports=JSON.parse('{"frames":{"idle-1":{"x":0,"y":0,"w":100,"h":100},"idle-2":{"x":100,"y":0,"w":100,"h":100},"idle-3":{"x":200,"y":0,"w":100,"h":100},"idle-4":{"x":300,"y":0,"w":100,"h":100},"idle-5":{"x":400,"y":0,"w":100,"h":100},"idle-6":{"x":500,"y":0,"w":100,"h":100},"walk-1":{"x":0,"y":100,"w":100,"h":100},"walk-2":{"x":100,"y":100,"w":100,"h":100},"walk-3":{"x":200,"y":100,"w":100,"h":100},"walk-4":{"x":300,"y":100,"w":100,"h":100},"walk-5":{"x":400,"y":100,"w":100,"h":100},"walk-6":{"x":500,"y":100,"w":100,"h":100},"walk-7":{"x":600,"y":100,"w":100,"h":100},"walk-8":{"x":700,"y":100,"w":100,"h":100},"attack1-1":{"x":0,"y":200,"w":100,"h":100},"attack1-2":{"x":100,"y":200,"w":100,"h":100},"attack1-3":{"x":200,"y":200,"w":100,"h":100},"attack1-4":{"x":300,"y":200,"w":100,"h":100},"attack1-5":{"x":400,"y":200,"w":100,"h":100},"attack1-6":{"x":500,"y":200,"w":100,"h":100},"attack2-1":{"x":0,"y":300,"w":100,"h":100},"attack2-2":{"x":100,"y":300,"w":100,"h":100},"attack2-3":{"x":200,"y":300,"w":100,"h":100},"attack2-4":{"x":300,"y":300,"w":100,"h":100},"attack2-5":{"x":400,"y":300,"w":100,"h":100},"attack2-6":{"x":500,"y":300,"w":100,"h":100},"die-1":{"x":0,"y":500,"w":100,"h":100},"die-2":{"x":100,"y":500,"w":100,"h":100},"die-3":{"x":200,"y":500,"w":100,"h":100},"die-4":{"x":300,"y":500,"w":100,"h":100}},"animations":{"idle":{"frames":["idle-1","idle-2","idle-3","idle-4","idle-5","idle-6"],"fps":10,"loop":true},"walk":{"frames":["walk-1","walk-2","walk-3","walk-4","walk-5","walk-6","walk-7","walk-8"],"fps":10,"loop":true},"attack1":{"frames":["attack1-1","attack1-2","attack1-3","attack1-4","attack1-5","attack1-6"],"fps":10,"loop":false},"attack2":{"frames":["attack2-1","attack2-2","attack2-3","attack2-4","attack2-5","attack2-6"],"fps":10,"loop":false},"die":{"frames":["die-1","die-2","die-3","die-4"],"fps":10,"loop":false}}}')},6145:(t,e,s)=>{s.d(e,{f:()=>h});var i=s(9496),o=s(6325),a=s(331),n=s(2365),r=s(7229);class h{#W;#j;#Y;#q;#K;constructor(t,e,s,h,l){this.#W=new r.s(t,0,l);let c=this.#W.byteLength;this.#j=new n.a(t,c,l),c+=this.#j.byteLength,this.#Y=new i.b(t,c,e,l),c+=this.#Y.byteLength,this.#q=new a.I(t,c,s,l),c+=this.#q.byteLength,this.#K=new o.i(t,c,h,l)}static bytesRequired(t,e,s,h){return r.s.bytesRequired(h)+n.a.bytesRequired(h)+i.b.bytesRequired(t,h)+a.I.bytesRequired(e,h)+o.i.bytesRequired(s,h)}newChild(t){const e=this.#W.alloc();return this.#j.insert(t,e),e}getParent(t){return this.#j.parent(t)}insertAt(t,e,s){this.#j.insertAt(t,e,s)}remove(t){this.#j.remove(t),this.#W.free(t)}setBoolean(t,e,s){this.#Y.set(t,e,s)}getBoolean(t,e){return this.#Y.get(t,e)}setUint32(t,e,s){this.#q.set(t,e,s)}getUint32(t,e){return this.#q.get(t,e)}setFloat32(t,e,s){this.#K.set(t,e,s)}getFloat32(t,e){return this.#K.get(t,e)}forEach(t){this.#j.forEach(t)}sortChildren(t,e){this.#j.sortChildren(t,e)}}},6325:(t,e,s)=>{s.d(e,{i:()=>i});class i{#t;#e;constructor(t,e,s,i){this.#e=s,this.#t=new Float32Array(t,e,s*i)}static bytesRequired(t,e){return t*e*Float32Array.BYTES_PER_ELEMENT}get byteLength(){return this.#t.byteLength}#s(t){return t*this.#e}set(t,e,s){this.#t[this.#s(t)+e]=s}get(t,e){return this.#t[this.#s(t)+e]}}},7229:(t,e,s)=>{s.d(e,{s:()=>o});var i=s(2802);class o{#z;constructor(t,e,s){this.#z=new i.F(t,e,s-1)}static bytesRequired(t){return i.F.bytesRequired(t-1)}get byteLength(){return this.#z.byteLength}alloc(){return this.#z.dequeue()}free(t){this.#z.enqueue(t)}}},7782:(t,e,s)=>{s.d(e,{A:()=>i,r:()=>r});var i,o=s(8700),a=s(5478),n=s(8791);!function(t){t[t.SPRITE_HERO=0]="SPRITE_HERO",t[t.SPRITE_ORC=1]="SPRITE_ORC",t[t.SPRITE_POTION=2]="SPRITE_POTION",t[t.FONT_WHITE_PEABERRY=3]="FONT_WHITE_PEABERRY",t[t.BGM_BATTLE=4]="BGM_BATTLE",t[t.SFX_HERO_HIT_1=5]="SFX_HERO_HIT_1",t[t.SFX_HERO_HIT_2=6]="SFX_HERO_HIT_2",t[t.SFX_HERO_HIT_3=7]="SFX_HERO_HIT_3",t[t.SFX_HERO_MISS_1=8]="SFX_HERO_MISS_1",t[t.SFX_HERO_MISS_2=9]="SFX_HERO_MISS_2",t[t.SFX_HERO_MISS_3=10]="SFX_HERO_MISS_3",t[t.SFX_HERO_HEAL=11]="SFX_HERO_HEAL",t[t.SFX_HERO_DIE=12]="SFX_HERO_DIE",t[t.SFX_ORC_HIT_1=13]="SFX_ORC_HIT_1",t[t.SFX_ORC_HIT_2=14]="SFX_ORC_HIT_2",t[t.SFX_ORC_HIT_3=15]="SFX_ORC_HIT_3",t[t.SFX_ORC_MISS_1=16]="SFX_ORC_MISS_1",t[t.SFX_ORC_MISS_2=17]="SFX_ORC_MISS_2",t[t.SFX_ORC_MISS_3=18]="SFX_ORC_MISS_3",t[t.SFX_ORC_DIE=19]="SFX_ORC_DIE"}(i||(i={}));const r={[i.SPRITE_HERO]:{src:"assets/spritesheets/hero.png",atlas:o},[i.SPRITE_ORC]:{src:"assets/spritesheets/orc.png",atlas:a},[i.SPRITE_POTION]:{src:"assets/spritesheets/potion.png",atlas:n},[i.FONT_WHITE_PEABERRY]:{fnt:"assets/bitmap-fonts/white-peaberry.fnt",src:"assets/bitmap-fonts/white-peaberry.png"},[i.BGM_BATTLE]:"assets/bgm/battle.mp3",[i.SFX_HERO_HIT_1]:"assets/sfx/hero/hit/hit1.wav",[i.SFX_HERO_HIT_2]:"assets/sfx/hero/hit/hit2.wav",[i.SFX_HERO_HIT_3]:"assets/sfx/hero/hit/hit3.wav",[i.SFX_HERO_MISS_1]:"assets/sfx/hero/miss/miss1.wav",[i.SFX_HERO_MISS_2]:"assets/sfx/hero/miss/miss2.wav",[i.SFX_HERO_MISS_3]:"assets/sfx/hero/miss/miss3.wav",[i.SFX_HERO_HEAL]:"assets/sfx/hero/heal/heal.wav",[i.SFX_HERO_DIE]:"assets/sfx/hero/die/die.wav",[i.SFX_ORC_HIT_1]:"assets/sfx/orc/hit/hit1.wav",[i.SFX_ORC_HIT_2]:"assets/sfx/orc/hit/hit2.wav",[i.SFX_ORC_HIT_3]:"assets/sfx/orc/hit/hit3.wav",[i.SFX_ORC_MISS_1]:"assets/sfx/orc/miss/miss1.wav",[i.SFX_ORC_MISS_2]:"assets/sfx/orc/miss/miss2.wav",[i.SFX_ORC_MISS_3]:"assets/sfx/orc/miss/miss3.wav",[i.SFX_ORC_DIE]:"assets/sfx/orc/die/die.wav"}},7867:(t,e,s)=>{s.d(e,{Z:()=>h});var i=s(1266);const o=new Set(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"]);function a(t){return o.has(t)}function n(t,e,s){const i=Math.hypot(t,e);if(i<=s||0===i)return{x:t,y:e,dist:i};const o=s/i;return{x:t*o,y:e*o,dist:s}}function r(t,e,s){t&&(t.style.left=`${e}px`,t.style.top=`${s}px`)}class h{container;#G=new Set;#V=new Set;#Z;#Q=0;#J=0;#tt=!1;#et;#st;#it;#ot;#at;#nt;#rt;#ht;constructor(t,e){this.container=t,this.#nt=e.onMove,this.#rt=e.onRelease,this.#ht=e.onKeyDown,this.#et=e.joystickImage,this.#st=e.knobImage,this.#it=e.maxKnobDistance??80,this.#ot=e.moveThreshold??0,this.#at=e.idlePosition??{left:-999999,top:-999999},window.addEventListener("keydown",this.#lt),window.addEventListener("keyup",this.#ct),window.addEventListener("blur",this.#dt),t.addEventListener("touchstart",this.#ut,{passive:!1}),t.addEventListener("touchmove",this.#mt,{passive:!1}),t.addEventListener("touchend",this.#ft),t.addEventListener("touchcancel",this.#ft),this.#et&&((0,i.eC)(this.#et,{position:"absolute",left:`${this.#at.left}px`,top:`${this.#at.top}px`,zIndex:"999998",transform:"translate(-50%, -50%)",pointerEvents:"none"}),t.appendChild(this.#et)),this.#st&&((0,i.eC)(this.#st,{position:"absolute",left:`${this.#at.left}px`,top:`${this.#at.top}px`,zIndex:"999999",transform:"translate(-50%, -50%)",pointerEvents:"none"}),t.appendChild(this.#st))}#ut=t=>{if(t.preventDefault(),void 0!==this.#Z)return;const e=t.changedTouches[0];this.#Z=e.identifier,this.#Q=e.clientX,this.#J=e.clientY,this.#tt=!1;const s=this.container.getBoundingClientRect(),i=this.#Q-s.left,o=this.#J-s.top;r(this.#et,i,o),r(this.#st,i,o)};#mt=t=>{if(t.preventDefault(),void 0!==this.#Z)for(let e=0;e<t.changedTouches.length;e++){const s=t.changedTouches[e];if(s.identifier!==this.#Z)continue;const i=s.clientX-this.#Q,o=s.clientY-this.#J,{x:a,y:h,dist:l}=n(i,o,this.#it),c=this.container.getBoundingClientRect(),d=this.#Q-c.left+a,u=this.#J-c.top+h;if(r(this.#st,d,u),(this.#tt||l>=this.#ot)&&(this.#tt=!0,0!==a||0!==h)){const t=Math.atan2(h,a),e=0===this.#it?0:l/this.#it;this.#nt(t,e)}break}};#ft=t=>{if(void 0===this.#Z)return;let e=!1;for(let s=0;s<t.changedTouches.length;s++)if(t.changedTouches[s].identifier===this.#Z){e=!0;break}if(!e)return;this.#Z=void 0;const{left:s,top:i}=this.#at;r(this.#et,s,i),r(this.#st,s,i),this.#tt&&(this.#tt=!1,this.#rt())};#wt(){let t=0,e=0;if(this.#V.has("ArrowUp")&&(e-=1),this.#V.has("ArrowDown")&&(e+=1),this.#V.has("ArrowLeft")&&(t-=1),this.#V.has("ArrowRight")&&(t+=1),0!==t||0!==e){const s=Math.atan2(e,t);this.#nt(s,1)}}#lt=t=>{const e=t.code;if(!this.#G.has(e)&&(this.#G.add(e),this.#ht?.(e),a(e))){const s=t.target;!!s?.closest('input, textarea, [contenteditable]:not([contenteditable="false"])')||t.preventDefault(),this.#V.add(e),this.#wt()}};#ct=t=>{const e=t.code;this.#G.delete(e),a(e)&&(this.#V.delete(e),0===this.#V.size?this.#rt():this.#wt())};#dt=()=>{this.#G.clear(),this.#V.clear(),this.#Z=void 0,this.#tt=!1;const{left:t,top:e}=this.#at;r(this.#et,t,e),r(this.#st,t,e),this.#rt()};setIdlePosition(t){this.#at=t,void 0===this.#Z&&(r(this.#et,t.left,t.top),r(this.#st,t.left,t.top))}remove(){this.container.removeEventListener("touchstart",this.#ut),this.container.removeEventListener("touchmove",this.#mt),this.container.removeEventListener("touchend",this.#ft),this.container.removeEventListener("touchcancel",this.#ft),window.removeEventListener("keydown",this.#lt),window.removeEventListener("keyup",this.#ct),window.removeEventListener("blur",this.#dt),this.#et?.remove(),this.#st?.remove()}}},8700:t=>{t.exports=JSON.parse('{"frames":{"idle-1":{"x":0,"y":0,"w":100,"h":100},"idle-2":{"x":100,"y":0,"w":100,"h":100},"idle-3":{"x":200,"y":0,"w":100,"h":100},"idle-4":{"x":300,"y":0,"w":100,"h":100},"idle-5":{"x":400,"y":0,"w":100,"h":100},"idle-6":{"x":500,"y":0,"w":100,"h":100},"walk-1":{"x":0,"y":100,"w":100,"h":100},"walk-2":{"x":100,"y":100,"w":100,"h":100},"walk-3":{"x":200,"y":100,"w":100,"h":100},"walk-4":{"x":300,"y":100,"w":100,"h":100},"walk-5":{"x":400,"y":100,"w":100,"h":100},"walk-6":{"x":500,"y":100,"w":100,"h":100},"walk-7":{"x":600,"y":100,"w":100,"h":100},"walk-8":{"x":700,"y":100,"w":100,"h":100},"attack1-1":{"x":0,"y":200,"w":100,"h":100},"attack1-2":{"x":100,"y":200,"w":100,"h":100},"attack1-3":{"x":200,"y":200,"w":100,"h":100},"attack1-4":{"x":300,"y":200,"w":100,"h":100},"attack1-5":{"x":400,"y":200,"w":100,"h":100},"attack1-6":{"x":500,"y":200,"w":100,"h":100},"attack2-1":{"x":0,"y":300,"w":100,"h":100},"attack2-2":{"x":100,"y":300,"w":100,"h":100},"attack2-3":{"x":200,"y":300,"w":100,"h":100},"attack2-4":{"x":300,"y":300,"w":100,"h":100},"attack2-5":{"x":400,"y":300,"w":100,"h":100},"attack2-6":{"x":500,"y":300,"w":100,"h":100},"die-1":{"x":0,"y":600,"w":100,"h":100},"die-2":{"x":100,"y":600,"w":100,"h":100},"die-3":{"x":200,"y":600,"w":100,"h":100},"die-4":{"x":300,"y":600,"w":100,"h":100}},"animations":{"idle":{"frames":["idle-1","idle-2","idle-3","idle-4","idle-5","idle-6"],"fps":10,"loop":true},"walk":{"frames":["walk-1","walk-2","walk-3","walk-4","walk-5","walk-6","walk-7","walk-8"],"fps":10,"loop":true},"attack1":{"frames":["attack1-1","attack1-2","attack1-3","attack1-4","attack1-5","attack1-6"],"fps":10,"loop":false},"attack2":{"frames":["attack2-1","attack2-2","attack2-3","attack2-4","attack2-5","attack2-6"],"fps":10,"loop":false},"die":{"frames":["die-1","die-2","die-3","die-4"],"fps":10,"loop":false}}}')},8791:t=>{t.exports=JSON.parse('{"frames":{"frame-1":{"x":0,"y":0,"w":16,"h":16},"frame-2":{"x":16,"y":0,"w":16,"h":16},"frame-3":{"x":32,"y":0,"w":16,"h":16},"frame-4":{"x":0,"y":16,"w":16,"h":16},"frame-5":{"x":16,"y":16,"w":16,"h":16},"frame-6":{"x":32,"y":16,"w":16,"h":16},"frame-7":{"x":0,"y":32,"w":16,"h":16},"frame-8":{"x":16,"y":32,"w":16,"h":16}},"animations":{"animation":{"frames":["frame-1","frame-2","frame-3","frame-4","frame-5","frame-6","frame-7","frame-8"],"fps":10,"loop":true}}}')},9496:(t,e,s)=>{s.d(e,{b:()=>i});class i{#pt;#e;constructor(t,e,s,i){this.#e=s;const o=s*i,a=Math.ceil(o/32);this.#pt=new Uint32Array(t,e,a)}static bytesRequired(t,e){const s=t*e;return Math.ceil(s/32)*Uint32Array.BYTES_PER_ELEMENT}get byteLength(){return this.#pt.byteLength}#gt(t,e){return t*this.#e+e}set(t,e,s){const i=this.#gt(t,e),o=i>>>5,a=1<<(31&i);s?this.#pt[o]|=a:this.#pt[o]&=~a}get(t,e){const s=this.#gt(t,e),i=s>>>5,o=1<<(31&s);return 0!==(this.#pt[i]&o)}}}},n={};function r(t){var e=n[t];if(void 0!==e)return e.exports;var s=n[t]={exports:{}};return a[t](s,s.exports,r),s.exports}t="function"==typeof Symbol,e=t?Symbol("webpack queues"):"__webpack_queues__",s=t?Symbol("webpack exports"):"__webpack_exports__",i=t?Symbol("webpack error"):"__webpack_error__",o=t=>{t&&t.d<1&&(t.d=1,t.forEach(t=>t.r--),t.forEach(t=>t.r--?t.r++:t()))},r.a=(t,a,n)=>{var r;n&&((r=[]).d=-1);var h,l,c,d=new Set,u=t.exports,m=new Promise((t,e)=>{c=e,l=t});m[s]=u,m[e]=t=>(r&&t(r),d.forEach(t),m.catch(t=>{})),t.exports=m,a(t=>{var a;h=(t=>t.map(t=>{if(null!==t&&"object"==typeof t){if(t[e])return t;if(t.then){var a=[];a.d=0,t.then(t=>{n[s]=t,o(a)},t=>{n[i]=t,o(a)});var n={};return n[e]=t=>t(a),n}}var r={};return r[e]=t=>{},r[s]=t,r}))(t);var n=()=>h.map(t=>{if(t[i])throw t[i];return t[s]}),l=new Promise(t=>{(a=()=>t(n)).r=0;var s=t=>t!==r&&!d.has(t)&&(d.add(t),t&&!t.d&&(a.r++,t.push(a)));h.map(t=>t[e](s))});return a.r?l:n()},t=>(t?c(m[i]=t):l(u),o(r))),r&&r.d<0&&(r.d=0)},r.d=(t,e)=>{for(var s in e)r.o(e,s)&&!r.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r(73)})();