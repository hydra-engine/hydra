{"version":3,"file":"local-transform.js","sourceRoot":"","sources":["../../../src/logic-node/core/local-transform.ts"],"names":[],"mappings":"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","sourcesContent":["import { ObjectStateTree } from '@hydraengine/shared'\n\nexport class LocalTransform {\n  #id?: number\n  #stateTree?: ObjectStateTree\n\n  #cachedX = 0\n  #cachedY = 0\n  #cachedScaleX = 1\n  #cachedScaleY = 1\n  #cachedPivotX = 0\n  #cachedPivotY = 0\n  #cachedRotation = 0\n  #cachedCos = 1\n  #cachedSin = 0\n\n  get x() {\n    const id = this.#id\n    const tree = this.#stateTree\n    if (tree && id !== undefined) {\n      return tree.getWorldX(id)\n    }\n    return this.#cachedX\n  }\n\n  set x(v) {\n    if (this.x !== v) {\n      this.#cachedX = v\n\n      const id = this.#id\n      const tree = this.#stateTree\n      if (tree && id !== undefined) {\n        tree.setLocalX(id, v)\n      }\n    }\n  }\n\n  get y() {\n    const id = this.#id\n    const tree = this.#stateTree\n    if (tree && id !== undefined) {\n      return tree.getWorldY(id)\n    }\n    return this.#cachedY\n  }\n\n  set y(v) {\n    if (this.y !== v) {\n      this.#cachedY = v\n\n      const id = this.#id\n      const tree = this.#stateTree\n      if (tree && id !== undefined) {\n        tree.setLocalY(id, v)\n      }\n    }\n  }\n\n  get scaleX() {\n    const id = this.#id\n    const tree = this.#stateTree\n    if (tree && id !== undefined) {\n      return tree.getWorldScaleX(id)\n    }\n    return this.#cachedScaleX\n  }\n\n  set scaleX(v) {\n    if (this.scaleX !== v) {\n      this.#cachedScaleX = v\n\n      const id = this.#id\n      const tree = this.#stateTree\n      if (tree && id !== undefined) {\n        tree.setLocalScaleX(id, v)\n      }\n    }\n  }\n\n  get scaleY() {\n    const id = this.#id\n    const tree = this.#stateTree\n    if (tree && id !== undefined) {\n      return tree.getWorldScaleY(id)\n    }\n    return this.#cachedScaleY\n  }\n\n  set scaleY(v) {\n    if (this.scaleY !== v) {\n      this.#cachedScaleY = v\n\n      const id = this.#id\n      const tree = this.#stateTree\n      if (tree && id !== undefined) {\n        tree.setLocalScaleY(id, v)\n      }\n    }\n  }\n\n  get pivotX() {\n    const id = this.#id\n    const tree = this.#stateTree\n    if (tree && id !== undefined) {\n      return tree.getLocalPivotX(id)\n    }\n    return this.#cachedPivotX\n  }\n\n  set pivotX(v) {\n    if (this.pivotX !== v) {\n      this.#cachedPivotX = v\n\n      const id = this.#id\n      const tree = this.#stateTree\n      if (tree && id !== undefined) {\n        tree.setLocalPivotX(id, v)\n      }\n    }\n  }\n\n  get pivotY() {\n    const id = this.#id\n    const tree = this.#stateTree\n    if (tree && id !== undefined) {\n      return tree.getLocalPivotY(id)\n    }\n    return this.#cachedPivotY\n  }\n\n  set pivotY(v) {\n    if (this.pivotY !== v) {\n      this.#cachedPivotY = v\n\n      const id = this.#id\n      const tree = this.#stateTree\n      if (tree && id !== undefined) {\n        tree.setLocalPivotY(id, v)\n      }\n    }\n  }\n\n  get rotation() {\n    const id = this.#id\n    const tree = this.#stateTree\n    if (tree && id !== undefined) {\n      return tree.getLocalRotation(id)\n    }\n    return this.#cachedRotation\n  }\n\n  set rotation(v) {\n    if (this.rotation !== v) {\n      this.#cachedRotation = v\n\n      const cos = Math.cos(v)\n      const sin = Math.sin(v)\n      this.#cachedCos = cos\n      this.#cachedSin = sin\n\n      const id = this.#id\n      const tree = this.#stateTree\n      if (tree && id !== undefined) {\n        tree.setLocalRotation(id, v)\n        tree.setLocalCos(id, cos)\n        tree.setLocalSin(id, sin)\n      }\n    }\n  }\n\n  setStateTree(id: number, tree: ObjectStateTree) {\n    this.#id = id\n    this.#stateTree = tree\n\n    tree.setLocalX(id, this.#cachedX)\n    tree.setLocalY(id, this.#cachedY)\n    tree.setLocalScaleX(id, this.#cachedScaleX)\n    tree.setLocalScaleY(id, this.#cachedScaleY)\n    tree.setLocalPivotX(id, this.#cachedPivotX)\n    tree.setLocalPivotY(id, this.#cachedPivotY)\n    tree.setLocalRotation(id, this.#cachedRotation)\n    tree.setLocalCos(id, this.#cachedCos)\n    tree.setLocalSin(id, this.#cachedSin)\n  }\n\n  clearStateTree() {\n    this.#id = undefined\n    this.#stateTree = undefined\n  }\n}\n"]}