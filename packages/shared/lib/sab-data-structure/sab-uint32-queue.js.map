{"version":3,"file":"sab-uint32-queue.js","sourceRoot":"","sources":["../../src/sab-data-structure/sab-uint32-queue.ts"],"names":[],"mappings":"AAAA,MAAM,SAAS,GAAG,CAAU,CAAA;AAE5B,MAAM,OAAO,cAAc;IAChB,KAAK,CAAa;IAClB,KAAK,CAAa;IAClB,IAAI,CAAQ;IAErB,YAAY,GAAsB,EAAE,UAAkB,EAAE,GAAW;QACjE,IAAI,CAAC,KAAK,GAAG,IAAI,WAAW,CAAC,GAAG,EAAE,UAAU,EAAE,SAAS,CAAC,CAAA;QACxD,IAAI,CAAC,KAAK,GAAG,IAAI,WAAW,CAC1B,GAAG,EACH,UAAU,GAAG,SAAS,GAAG,WAAW,CAAC,iBAAiB,EACtD,GAAG,CACJ,CAAA;QACD,IAAI,CAAC,IAAI,GAAG,GAAG,CAAA;IACjB,CAAC;IAED,MAAM,CAAC,aAAa,CAAC,GAAW,IAAI,OAAO,CAAC,SAAS,GAAG,GAAG,CAAC,GAAG,WAAW,CAAC,iBAAiB,CAAA,CAAC,CAAC;IAC9F,IAAI,UAAU,KAAK,OAAO,IAAI,CAAC,KAAK,CAAC,UAAU,GAAG,IAAI,CAAC,KAAK,CAAC,UAAU,CAAA,CAAC,CAAC;IAEzE,OAAO,CAAC,CAAS;QACf,MAAM,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAA;QAC1B,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,CAAA;QACpB,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI,GAAG,CAAC,CAAC,GAAG,IAAI,CAAC,IAAI,CAAA;IACxC,CAAC;IAED,OAAO;QACL,MAAM,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAA;QAC1B,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI,GAAG,CAAC,CAAC,GAAG,IAAI,CAAC,IAAI,CAAA;QACtC,OAAO,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAA;IACzB,CAAC;CACF","sourcesContent":["const CTRL_SIZE = 2 as const\n\nexport class SabUint32Queue {\n  readonly #ctrl: Uint32Array\n  readonly #data: Uint32Array\n  readonly #cap: number\n\n  constructor(sab: SharedArrayBuffer, byteOffset: number, cap: number) {\n    this.#ctrl = new Uint32Array(sab, byteOffset, CTRL_SIZE)\n    this.#data = new Uint32Array(\n      sab,\n      byteOffset + CTRL_SIZE * Uint32Array.BYTES_PER_ELEMENT,\n      cap\n    )\n    this.#cap = cap\n  }\n\n  static bytesRequired(cap: number) { return (CTRL_SIZE + cap) * Uint32Array.BYTES_PER_ELEMENT }\n  get byteLength() { return this.#ctrl.byteLength + this.#data.byteLength }\n\n  enqueue(v: number) {\n    const tail = this.#ctrl[1]\n    this.#data[tail] = v\n    this.#ctrl[1] = (tail + 1) % this.#cap\n  }\n\n  dequeue(): number {\n    const head = this.#ctrl[0]\n    this.#ctrl[0] = (head + 1) % this.#cap\n    return this.#data[head]\n  }\n}\n"]}